<!DOCTYPE html>
<html>
	<head>
		<title>Python</title>
		<link rel="stylesheet" href="../css/atelier-sulphurpool-light.css" type="text/css">
		<script src="../js/google-code-prettify/run_prettify.js?autoload=true&amp;lang=css"></script>
		<style>
			div.title {color: navy; font-weight: bold; width: 80%; font-size: 32px; text-align: center; position: relative; margin: auto;}
			div.subtitle {color: navy; font-weight: bold; width: 80%; font-size: 24px; text-align: position: relative; margin: auto;}
			div.block {color: navy; font-weight: bold; width: 80%; border-style: solid; padding: 5px; position: relative; margin: 10px auto; border-radius: 5px;}
		</style>
	</head>
	<body>
		<div class = "title">
			defaultdict
		</div>
		<div class = "block">
            <li>a new dictionary-like object</li>
            <li>overrides one method and adds one writable instance variable</li>
            <li>the remaining functionality is the same as for the dict class</li>
            <li>the type of the value for each key can be specified</li>
        </div>
		<div class = "subtitle">Initialization</div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# default_factory=None, defaultdict has the same performance as dict
import collections

def default_factory():
    return 'default value'

d = collections.defaultdict()

d['blue'] = 20 # defaultdict(None, {'blue': 20})

# print(d['red']) # key doesn't exist, raise KeyError
            </pre>
        </div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# default_factory=func_missing, if key does not exist, insert key with default value
import collections

def func_missing():
    return 0

d = collections.defaultdict(default_factory = func_missing)

d['blue'] = 20 # defaultdict(&lt;function func_missing at 0x108af04a0&gt;, {'blue': 20})

print(d['red']) # key doesn't exist, insert key with default value
# defaultdict(&lt;function func_missing at 0x108af04a0&gt;, {'blue': 20, 'red': 0})
            </pre>
        </div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# list
from collections import defaultdict

s = [('yellow', 1), ('blue', 2), ('yellow', 3), ('blue', 4), ('red', 1)]
d_list = defaultdict(list) # each value is a list
for k, v in s:
    # access key which does not exist
    # insert key with an empty list
    # append value to list
    d_list[k].append(v)

print(d_list) # defaultdict(list, {'yellow': [1, 3], 'blue': [2, 4], 'red': [1]})
            </pre>
        </div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# dict
from collections import defaultdict

s = [('yellow', 1), ('blue', 2), ('yellow', 3), ('blue', 4), ('red', 1)]
d_dict = defaultdict(dict) # each value is a list
for k, v in s:
    # access key which does not exist
    # insert key with an empty dict
    # add key/value to dict
    d_dict[k][v] = 0
    
print(d_dict) # defaultdict(<class 'dict'>, {'yellow': {1: 0, 3: 0}, 'blue': {2: 0, 4: 0}, 'red': {1: 0}})
            </pre>
        </div>
		<div class = "subtitle">Methods</div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# list
list(d_list.keys()) # ['yellow', 'blue', 'red']
list(d_list.values()) # [[1, 3], [2, 4], [1]]
list(d_list.items()) # [('yellow', [1, 3]), ('blue', [2, 4]), ('red', [1])]
            </pre>
        </div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# dict
list(d_dict.keys()) # ['yellow', 'blue', 'red']
list(d_dict.values()) # [{1: 0, 3: 0}, {2: 0, 4: 0}, {1: 0}]
list(d_dict.items()) # [('yellow', {1: 0, 3: 0}), ('blue', {2: 0, 4: 0}), ('red', {1: 0})]
            </pre>
        </div>
		<div class = "subtitle">Built-in Functions</div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# list
# convert to dict
dict(d_list) # {'yellow': [1, 3], 'blue': [2, 4], 'red': [1]}
            </pre>
        </div>
		<div class = "block">
			<pre class = "prettyprint linenums">
# dict
# convert to dict
dict(d_dict) # {'yellow': {1: 0, 3: 0}, 'blue': {2: 0, 4: 0}, 'red': {1: 0}}
            </pre>
        </div>
		<div class = "subtitle">Reference</div>
		<div class = "block">
            <li><a href = "https://docs.python.org/3/library/collections.html#collections.defaultdict">Python 3 Standard Library</a></li>
            <li><a href = "https://pymotw.com/3/collections/defaultdict.html">PyMOTW-3</a></li>
        </div>
    </body>
</html>
